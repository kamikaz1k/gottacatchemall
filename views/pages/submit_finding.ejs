<!DOCTYPE html>
<html>
<head>
  <title>Monster Catch!</title>
  <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

  <!-- Leaflet Scripts -->
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
  <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
  <!-- Leaflet End -->

  <!-- Select2 Scripts -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>
  <!-- Select2 End -->

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
  <div class="container">
    <h1>Welcome to Poke Catch!</h1>
    <h2>Where did you find it?</h2>

    <!-- <label>Longitude:</label>
    <input id="geo-long" placeholder="Long: 43.6532">

    <label for="geo-lat" >Lattitude:</label>
    <input id="geo-lat" class="form-control" placeholder="Lat: 79.3832">

    <button type="submit" id="locate-btn" class="btn btn-primary">Locate</button>
  </div> -->
  <div>
    <form class="form-horizontal">

      <div class="form-group">
        <label for="found-poke" class="col-sm-2 control-label">Pokemon:</label>
        <div class="col-sm-10">
          <!-- <input type="text" class="form-control" id="found-poke" placeholder="Blastoise" required> -->
          <!-- <select type="text" class="form-control" id="found-poke" placeholder="Blastoise" required> -->

          <select id="pokemon-input"></select>
        </div>
      </div>

      <div class="form-group">
        <label for="found-address" class="col-sm-2 control-label">Address/Landmark:</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" id="found-address" placeholder="Central Park, NY" required>
          <!-- TODO: Google Places Auto Complete -->
        </div>
      </div>

      <div class="form-group">
        <label for="found-geo" class="col-sm-2 control-label">GeoLocation:</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" id="found-geo" disabled>
        </div>
      </div>

      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
        <button onclick="getLocation()" type="button" class="btn btn-primary">Get Current Location</button>
        <button onclick="submitEntry()" type="button" class="btn btn-primary">Submit Find</button>
        </div>
      </div>
    </form>

  </div>
</div>

  <div class="container">
    <div id="map" style="height: 180px;"></div>
  </div>

</body>
<script>
  function getLocation () {
    console.log("looking...");
    navigator.geolocation
    .getCurrentPosition(function (geoObj) {
      console.log('location found!', geoObj);
      $('#found-geo').val(geoObj.coords.latitude + ":" + geoObj.coords.longitude);

    }, function (error) {
      console.error('location not found!', error);
    });
  }

  function submitEntry () {
    // var pokemon = $("#pokemon-input").val();
    var selection = $("#pokemon-input").select2('data')[0];
    var location = $("#found-geo").val().split(":");

    console.log("Pokemon:", selection);

    var entry = {
      pokemon: selection.id,
      location: {
          latitude: location[0] || "",
          longitude: location[1] || ""
      },
      submitter: {
          user: {
              id: "98765",
              username: "ABBA"
          } 
      }
    }

    $.ajax({
        url: '/submit?entry=' + JSON.stringify(entry),
        type: 'POST',
        success: function(response) {
          console.log(response);
        },
        error: function (error) {
          console.log("ERROR", error);
        }
    });
  }

  window.pokemon = [{ "id":"001", "text":"Bulbasaur" },
{ "id":"002", "text":"Ivysaur" },
{ "id":"003", "text":"Venusaur" },
{ "id":"004", "text":"Charmander" },
{ "id":"005", "text":"Charmeleon" },
{ "id":"006", "text":"Charizard" },
{ "id":"007", "text":"Squirtle" },
{ "id":"008", "text":"Wartortle" },
{ "id":"009", "text":"Blastoise" },
{ "id":"010", "text":"Caterpie" },
{ "id":"011", "text":"Metapod" },
{ "id":"012", "text":"Butterfree" },
{ "id":"013", "text":"Weedle" },
{ "id":"014", "text":"Kakuna" },
{ "id":"015", "text":"Beedrill" },
{ "id":"016", "text":"Pidgey" },
{ "id":"017", "text":"Pidgeotto" },
{ "id":"018", "text":"Pidgeot" },
{ "id":"019", "text":"Rattata" },
{ "id":"020", "text":"Raticate" },
{ "id":"021", "text":"Spearow" },
{ "id":"022", "text":"Fearow" },
{ "id":"023", "text":"Ekans" },
{ "id":"024", "text":"Arbok" },
{ "id":"025", "text":"Pikachu" },
{ "id":"026", "text":"Raichu" },
{ "id":"027", "text":"Sandshrew" },
{ "id":"028", "text":"Sandslash" },
{ "id":"029", "text":"Nidoran♀" },
{ "id":"030", "text":"Nidorina" },
{ "id":"031", "text":"Nidoqueen" },
{ "id":"032", "text":"Nidoran♂" },
{ "id":"033", "text":"Nidorino" },
{ "id":"034", "text":"Nidoking" },
{ "id":"035", "text":"Clefairy" },
{ "id":"036", "text":"Clefable" },
{ "id":"037", "text":"Vulpix" },
{ "id":"038", "text":"Ninetales" },
{ "id":"039", "text":"Jigglypuff" },
{ "id":"040", "text":"Wigglytuff" },
{ "id":"041", "text":"Zubat" },
{ "id":"042", "text":"Golbat" },
{ "id":"043", "text":"Oddish" },
{ "id":"044", "text":"Gloom" },
{ "id":"045", "text":"Vileplume" },
{ "id":"046", "text":"Paras" },
{ "id":"047", "text":"Parasect" },
{ "id":"048", "text":"Venonat" },
{ "id":"049", "text":"Venomoth" },
{ "id":"050", "text":"Diglett" },
{ "id":"051", "text":"Dugtrio" },
{ "id":"052", "text":"Meowth" },
{ "id":"053", "text":"Persian" },
{ "id":"054", "text":"Psyduck" },
{ "id":"055", "text":"Golduck" },
{ "id":"056", "text":"Mankey" },
{ "id":"057", "text":"Primeape" },
{ "id":"058", "text":"Growlithe" },
{ "id":"059", "text":"Arcanine" },
{ "id":"060", "text":"Poliwag" },
{ "id":"061", "text":"Poliwhirl" },
{ "id":"062", "text":"Poliwrath" },
{ "id":"063", "text":"Abra" },
{ "id":"064", "text":"Kadabra" },
{ "id":"065", "text":"Alakazam" },
{ "id":"066", "text":"Machop" },
{ "id":"067", "text":"Machoke" },
{ "id":"068", "text":"Machamp" },
{ "id":"069", "text":"Bellsprout" },
{ "id":"070", "text":"Weepinbell" },
{ "id":"071", "text":"Victreebel" },
{ "id":"072", "text":"Tentacool" },
{ "id":"073", "text":"Tentacruel" },
{ "id":"074", "text":"Geodude" },
{ "id":"075", "text":"Graveler" },
{ "id":"076", "text":"Golem" },
{ "id":"077", "text":"Ponyta" },
{ "id":"078", "text":"Rapidash" },
{ "id":"079", "text":"Slowpoke" },
{ "id":"080", "text":"Slowbro" },
{ "id":"081", "text":"Magnemite" },
{ "id":"082", "text":"Magneton" },
{ "id":"083", "text":"Farfetch\'d" },
{ "id":"084", "text":"Doduo" },
{ "id":"085", "text":"Dodrio" },
{ "id":"086", "text":"Seel" },
{ "id":"087", "text":"Dewgong" },
{ "id":"088", "text":"Grimer" },
{ "id":"089", "text":"Muk" },
{ "id":"090", "text":"Shellder" },
{ "id":"091", "text":"Cloyster" },
{ "id":"092", "text":"Gastly" },
{ "id":"093", "text":"Haunter" },
{ "id":"094", "text":"Gengar" },
{ "id":"095", "text":"Onix" },
{ "id":"096", "text":"Drowzee" },
{ "id":"097", "text":"Hypno" },
{ "id":"098", "text":"Krabby" },
{ "id":"099", "text":"Kingler" },
{ "id":"100", "text":"Voltorb" },
{ "id":"101", "text":"Electrode" },
{ "id":"102", "text":"Exeggcute" },
{ "id":"103", "text":"Exeggutor" },
{ "id":"104", "text":"Cubone" },
{ "id":"105", "text":"Marowak" },
{ "id":"106", "text":"Hitmonlee" },
{ "id":"107", "text":"Hitmonchan" },
{ "id":"108", "text":"Lickitung" },
{ "id":"109", "text":"Koffing" },
{ "id":"110", "text":"Weezing" },
{ "id":"111", "text":"Rhyhorn" },
{ "id":"112", "text":"Rhydon" },
{ "id":"113", "text":"Chansey" },
{ "id":"114", "text":"Tangela" },
{ "id":"115", "text":"Kangaskhan" },
{ "id":"116", "text":"Horsea" },
{ "id":"117", "text":"Seadra" },
{ "id":"118", "text":"Goldeen" },
{ "id":"119", "text":"Seaking" },
{ "id":"120", "text":"Staryu" },
{ "id":"121", "text":"Starmie" },
{ "id":"122", "text":"Mr. Mime" },
{ "id":"123", "text":"Scyther" },
{ "id":"124", "text":"Jynx" },
{ "id":"125", "text":"Electabuzz" },
{ "id":"126", "text":"Magmar" },
{ "id":"127", "text":"Pinsir" },
{ "id":"128", "text":"Tauros" },
{ "id":"129", "text":"Magikarp" },
{ "id":"130", "text":"Gyarados" },
{ "id":"131", "text":"Lapras" },
{ "id":"132", "text":"Ditto" },
{ "id":"133", "text":"Eevee" },
{ "id":"134", "text":"Vaporeon" },
{ "id":"135", "text":"Jolteon" },
{ "id":"136", "text":"Flareon" },
{ "id":"137", "text":"Porygon" },
{ "id":"138", "text":"Omanyte" },
{ "id":"139", "text":"Omastar" },
{ "id":"140", "text":"Kabuto" },
{ "id":"141", "text":"Kabutops" },
{ "id":"142", "text":"Aerodactyl" },
{ "id":"143", "text":"Snorlax" },
{ "id":"144", "text":"Articuno" },
{ "id":"145", "text":"Zapdos" },
{ "id":"146", "text":"Moltres" },
{ "id":"147", "text":"Dratini" },
{ "id":"148", "text":"Dragonair" },
{ "id":"149", "text":"Dragonite" },
{ "id":"150", "text":"Mewtwo" },
{"id":"151", "text":"Mew" }]

  $("#pokemon-input").select2({
    data: window.pokemon,
    // multiple: true,
    width: '100%'
  })

</script>
</html>
